# spring_security_demo
**spring-boot-starter-security** \
Just by adding spring security dependency, we get a default login page with username and password.
To access any resource we need to provide username and password.\
**username**: user \
**password**: generated by spring security

**Implement Basic Auth Security**
1. Create a class, annotate it with @Configuration and @EnableWebSecurity and extend WebSecurityConfigurerAdapter.
2. Overrid configure(HttpSecurity http) and add below code.
 ```
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        // any request should be authenticated i.e user should provide username and password and mechanism should be basic auth
        // antMatchers --> to allow access to home page like index to all users without any username and password
        // antMatchers("/api/**").hasRole(STUDENT.name()) --> Only allow user who have a role of STUDENT to access this API

        http.authorizeRequests()
                .antMatchers("/", "index", "/css/*", "/js/*")
                .permitAll()
                .anyRequest()
                .authenticated()
                .and()
                .httpBasic();
    }
```

**Code Explaination**

```
http.authorizeRequests("authorize the request")
.antMatchers("/", "index", "/css/*", "/js/*")
.permitAll("means above listed urls in antMatchers are now whitelisted means they are accessible without username and password")
.anyRequest("any request")
.authenticated("should be authenticated")
.and("and also")
.httpBasic("mechanism should be basic auth");
```

**Create a User**
1. Override below method and annotate it with @Bean to create a user
```
    @Override
    @Bean
    protected UserDetailsService userDetailsService() {
        UserDetails mariumUser = User.builder()
                .username("student")
                .password("student")
                .roles("STUDENT")
                .build();

        return new InMemoryUserDetailsManager(mariumUser);
    }
```
**PasswordEncoder** \
Spring Security uses password encoder by default to encode the password and also enforces us to use the same. \
To create our own user we need to provide password encoder. Password Encoder is an interface and we must provide implementation of it. \
Spring enforces us to use BCryptPasswordEncoder which is the most famous password encoder at this time.

1. Create a configuration class and add below bean to it.

```
    @Bean
    public PasswordEncoder passwordEncoder(){
        return new BCryptPasswordEncoder(10);
    }
```
2. Then autowire this bean in ApplicationSecurityConfig and use it to encode the password like below. 
```
    @Override
    @Bean
    protected UserDetailsService userDetailsService() {
        UserDetails mariumUser = User.builder()
                .username("student")
                .password(passwordEncoder.encode("student"))
                .roles("STUDENT")
                .build();

        return new InMemoryUserDetailsManager(mariumUser);
    }
 ```
